import{N as e,M as t,E as r}from"./tiptap-7d2e9357.js";import{t as s,a,b as n,n as o,s as l,m as i,c as u,u as p,r as d,p as c}from"./tiptap-commands-ff2c84fd.js";import"./highlight.js-45c9f23d.js";import"./fault-4bc10d66.js";import{a as g,D as m}from"./prosemirror-view-0d94a9de.js";import{c as h,g as y,d as f}from"./tiptap-utils-dfe96f8c.js";import{P as b,T as O,a as k}from"./prosemirror-state-425d0e8b.js";import{t as M,a as _,b as D,c as w,e as x,f as C,g as A,h as S,m as v,s as $,i as R,j as T,k as j,l as E,n as z,o as W,p as N,q as H}from"./prosemirror-tables-fdb699ea.js";import{h as q,u as G,r as I,a as P,b as Z}from"./prosemirror-history-237c0715.js";import{w as B,t as L}from"./prosemirror-inputrules-f48e44a0.js";import{s as U,t as V,c as F,e as K}from"./prosemirror-commands-5439721d.js";import{s as Q,a as X,l as Y}from"./prosemirror-schema-list-cb4e861d.js";class J extends e{get name(){return"blockquote"}get schema(){return{content:"block*",group:"block",defining:!0,draggable:!1,parseDOM:[{tag:"blockquote"}],toDOM:()=>["blockquote",0]}}commands({type:e}){return()=>s(e)}keys({type:e}){return{"Ctrl->":s(e)}}inputRules({type:e}){return[B(/^\s*>\s$/,e)]}}class ee extends e{get name(){return"bullet_list"}get schema(){return{content:"list_item+",group:"block",parseDOM:[{tag:"ul"}],toDOM:()=>["ul",0]}}commands({type:e,schema:t}){return()=>a(e,t.nodes.list_item)}keys({type:e,schema:t}){return{"Shift-Ctrl-8":a(e,t.nodes.list_item)}}inputRules({type:e}){return[B(/^\s*([-+*])\s$/,e)]}}class te extends e{get name(){return"code_block"}get schema(){return{content:"text*",marks:"",group:"block",code:!0,defining:!0,draggable:!1,parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM:()=>["pre",["code",0]]}}commands({type:e,schema:t}){return()=>n(e,t.nodes.paragraph)}keys({type:e}){return{"Shift-Ctrl-\\":U(e)}}inputRules({type:e}){return[L(/^```$/,e)]}}class re extends e{get name(){return"hard_break"}get schema(){return{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>["br"]}}commands({type:e}){return()=>F(K,((t,r)=>(r(t.tr.replaceSelectionWith(e.create()).scrollIntoView()),!0)))}keys({type:e}){const t=F(K,((t,r)=>(r(t.tr.replaceSelectionWith(e.create()).scrollIntoView()),!0)));return{"Mod-Enter":t,"Shift-Enter":t}}}class se extends e{get name(){return"heading"}get defaultOptions(){return{levels:[1,2,3,4,5,6]}}get schema(){return{attrs:{level:{default:1}},content:"inline*",group:"block",defining:!0,draggable:!1,parseDOM:this.options.levels.map((e=>({tag:`h${e}`,attrs:{level:e}}))),toDOM:e=>[`h${e.attrs.level}`,0]}}commands({type:e,schema:t}){return r=>n(e,t.nodes.paragraph,r)}keys({type:e}){return this.options.levels.reduce(((t,r)=>({...t,[`Shift-Ctrl-${r}`]:U(e,{level:r})})),{})}inputRules({type:e}){return this.options.levels.map((t=>L(new RegExp(`^(#{1,${t}})\\s$`),e,(()=>({level:t})))))}}class ae extends e{get name(){return"horizontal_rule"}get schema(){return{group:"block",parseDOM:[{tag:"hr"}],toDOM:()=>["hr"]}}commands({type:e}){return()=>(t,r)=>r(t.tr.replaceSelectionWith(e.create()))}inputRules({type:e}){return[o(/^(?:---|___\s|\*\*\*\s)$/,e)]}}const ne=/!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\)/;class oe extends e{get name(){return"image"}get schema(){return{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:e=>({src:e.getAttribute("src"),title:e.getAttribute("title"),alt:e.getAttribute("alt")})}],toDOM:e=>["img",e.attrs]}}commands({type:e}){return t=>(r,s)=>{const{selection:a}=r,n=a.$cursor?a.$cursor.pos:a.$to.pos,o=e.create(t);s(r.tr.insert(n,o))}}inputRules({type:e}){return[o(ne,e,(e=>{const[,t,r,s]=e;return{src:r,alt:t,title:s}}))]}get plugins(){return[new b({props:{handleDOMEvents:{drop(e,t){if(!(t.dataTransfer&&t.dataTransfer.files&&t.dataTransfer.files.length))return;const r=Array.from(t.dataTransfer.files).filter((e=>/image/i.test(e.type)));if(0===r.length)return;t.preventDefault();const{schema:s}=e.state,a=e.posAtCoords({left:t.clientX,top:t.clientY});r.forEach((t=>{const r=new FileReader;r.onload=t=>{const r=s.nodes.image.create({src:t.target.result}),n=e.state.tr.insert(a.pos,r);e.dispatch(n)},r.readAsDataURL(t)}))}}}})]}}class le extends e{get name(){return"list_item"}get schema(){return{content:"paragraph block*",defining:!0,draggable:!1,parseDOM:[{tag:"li"}],toDOM:()=>["li",0]}}keys({type:e}){return{Enter:Q(e),Tab:X(e),"Shift-Tab":Y(e)}}}class ie extends e{get name(){return"ordered_list"}get schema(){return{attrs:{order:{default:1}},content:"list_item+",group:"block",parseDOM:[{tag:"ol",getAttrs:e=>({order:e.hasAttribute("start")?+e.getAttribute("start"):1})}],toDOM:e=>1===e.attrs.order?["ol",0]:["ol",{start:e.attrs.order},0]}}commands({type:e,schema:t}){return()=>a(e,t.nodes.list_item)}keys({type:e,schema:t}){return{"Shift-Ctrl-9":a(e,t.nodes.list_item)}}inputRules({type:e}){return[B(/^(\d+)\.\s$/,e,(e=>({order:+e[1]})),((e,t)=>t.childCount+t.attrs.order===+e[1]))]}}var ue=M({tableGroup:"block",cellContent:"block+",cellAttributes:{background:{default:null,getFromDOM:e=>e.style.backgroundColor||null,setDOMAttr(e,t){if(e){const r={style:`${t.style||""}background-color: ${e};`};Object.assign(t,r)}}}}});class pe extends e{get name(){return"table"}get defaultOptions(){return{resizable:!1}}get schema(){return ue.table}commands({schema:e}){return{createTable:({rowsCount:t,colsCount:r,withHeaderRow:s})=>(a,n)=>{const o=a.tr.selection.anchor+1,l=h(e,t,r,s),i=a.tr.replaceSelectionWith(l).scrollIntoView(),u=i.doc.resolve(o);i.setSelection(O.near(u)),n(i)},addColumnBefore:()=>_,addColumnAfter:()=>D,deleteColumn:()=>w,addRowBefore:()=>x,addRowAfter:()=>C,deleteRow:()=>A,deleteTable:()=>S,toggleCellMerge:()=>(e,t)=>{v(e,t)||$(e,t)},mergeCells:()=>v,splitCell:()=>$,toggleHeaderColumn:()=>R,toggleHeaderRow:()=>T,toggleHeaderCell:()=>j,setCellAttr:({name:e,value:t})=>E(e,t),fixTables:()=>z}}keys(){return{Tab:W(1),"Shift-Tab":W(-1)}}get plugins(){return[...this.options.resizable?[N()]:[],H()]}}class de extends e{get name(){return"table_header"}get schema(){return ue.table_header}}class ce extends e{get name(){return"table_cell"}get schema(){return ue.table_cell}}class ge extends e{get name(){return"table_row"}get schema(){return ue.table_row}}class me extends e{get name(){return"todo_item"}get defaultOptions(){return{nested:!1}}get view(){return{props:["node","updateAttrs","view"],methods:{onChange(){this.updateAttrs({done:!this.node.attrs.done})}},template:'\n        <li :data-type="node.type.name" :data-done="node.attrs.done.toString()" data-drag-handle>\n          <span class="todo-checkbox" contenteditable="false" @click="onChange"></span>\n          <div class="todo-content" ref="content" :contenteditable="view.editable.toString()"></div>\n        </li>\n      '}}get schema(){return{attrs:{done:{default:!1}},draggable:!0,content:this.options.nested?"(paragraph|todo_list)+":"paragraph+",toDOM:e=>{const{done:t}=e.attrs;return["li",{"data-type":this.name,"data-done":t.toString()},["span",{class:"todo-checkbox",contenteditable:"false"}],["div",{class:"todo-content"},0]]},parseDOM:[{priority:51,tag:`[data-type="${this.name}"]`,getAttrs:e=>({done:"true"===e.getAttribute("data-done")})}]}}keys({type:e}){return{Enter:l(e),Tab:this.options.nested?X(e):()=>{},"Shift-Tab":Y(e)}}}class he extends e{get name(){return"todo_list"}get schema(){return{group:"block",content:"todo_item+",toDOM:()=>["ul",{"data-type":this.name},0],parseDOM:[{priority:51,tag:`[data-type="${this.name}"]`}]}}commands({type:e,schema:t}){return()=>a(e,t.nodes.todo_item)}inputRules({type:e}){return[B(/^\s*(\[ \])\s$/,e)]}}class ye extends t{get name(){return"bold"}get schema(){return{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM:()=>["strong",0]}}keys({type:e}){return{"Mod-b":V(e)}}commands({type:e}){return()=>V(e)}inputRules({type:e}){return[i(/(?:\*\*|__)([^*_]+)(?:\*\*|__)$/,e)]}pasteRules({type:e}){return[u(/(?:\*\*|__)([^*_]+)(?:\*\*|__)/g,e)]}}class fe extends t{get name(){return"italic"}get schema(){return{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:()=>["em",0]}}keys({type:e}){return{"Mod-i":V(e)}}commands({type:e}){return()=>V(e)}inputRules({type:e}){return[i(/(?:^|[^_])(_([^_]+)_)$/,e),i(/(?:^|[^*])(\*([^*]+)\*)$/,e)]}pasteRules({type:e}){return[u(/_([^_]+)_/g,e),u(/\*([^*]+)\*/g,e)]}}class be extends t{get name(){return"link"}get defaultOptions(){return{openOnClick:!0,target:null}}get schema(){return{attrs:{href:{default:null},target:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:e=>({href:e.getAttribute("href"),target:e.getAttribute("target")})}],toDOM:e=>["a",{...e.attrs,rel:"noopener noreferrer nofollow",target:e.attrs.target||this.options.target},0]}}commands({type:e}){return t=>t.href?p(e,t):d(e)}pasteRules({type:e}){return[c(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z]{2,}\b([-a-zA-Z0-9@:%_+.~#?&//=,()!]*)/gi,e,(e=>({href:e})))]}get plugins(){return this.options.openOnClick?[new b({props:{handleClick:(e,t,r)=>{const{schema:s}=e.state,a=y(e.state,s.marks.link);a.href&&r.target instanceof HTMLAnchorElement&&(r.stopPropagation(),window.open(a.href,a.target))}}})]:[]}}class Oe extends t{get name(){return"strike"}get schema(){return{parseDOM:[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",getAttrs:e=>"line-through"===e}],toDOM:()=>["s",0]}}keys({type:e}){return{"Mod-d":V(e)}}commands({type:e}){return()=>V(e)}inputRules({type:e}){return[i(/~([^~]+)~$/,e)]}pasteRules({type:e}){return[u(/~([^~]+)~/g,e)]}}class ke extends t{get name(){return"underline"}get schema(){return{parseDOM:[{tag:"u"},{style:"text-decoration",getAttrs:e=>"underline"===e}],toDOM:()=>["u",0]}}keys({type:e}){return{"Mod-u":V(e)}}commands({type:e}){return()=>V(e)}}class Me extends r{get name(){return"history"}get defaultOptions(){return{depth:"",newGroupDelay:""}}keys(){return{"Mod-z":G,"Mod-y":I,"Shift-Mod-z":I,"Mod-я":G,"Shift-Mod-я":I}}get plugins(){return[q({depth:this.options.depth,newGroupDelay:this.options.newGroupDelay})]}commands(){return{undo:()=>G,redo:()=>I,undoDepth:()=>P,redoDepth:()=>Z}}}class _e extends r{get name(){return"placeholder"}get defaultOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",emptyNodeText:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0}}get plugins(){return[new b({props:{decorations:({doc:e,plugins:t,selection:r})=>{const s=t.find((e=>e.key.startsWith("editable$"))).props.editable()||!this.options.showOnlyWhenEditable,{anchor:a}=r,n=[],o=0===e.textContent.length;return!!s&&(e.descendants(((e,t)=>{const r=a>=t&&a<=t+e.nodeSize,s=0===e.content.size;if((r||!this.options.showOnlyCurrent)&&s){const r=[this.options.emptyNodeClass];o&&r.push(this.options.emptyEditorClass);const s=g.node(t,t+e.nodeSize,{class:r.join(" "),"data-empty-text":"function"==typeof this.options.emptyNodeText?this.options.emptyNodeText(e):this.options.emptyNodeText});n.push(s)}return!1})),m.create(e,n))}}})]}}class De extends r{get name(){return"trailing_node"}get defaultOptions(){return{node:"paragraph",notAfter:["paragraph"]}}get plugins(){const e=new k(this.name),t=Object.entries(this.editor.schema.nodes).map((([,e])=>e)).filter((e=>this.options.notAfter.includes(e.name)));return[new b({key:e,view:()=>({update:t=>{const{state:r}=t;if(!e.getState(r))return;const{doc:s,schema:a,tr:n}=r,o=a.nodes[this.options.node],l=n.insert(s.content.size,o.create());t.dispatch(l)}}),state:{init:(e,r)=>{const s=r.tr.doc.lastChild;return!f({node:s,types:t})},apply:(e,r)=>{if(!e.docChanged)return r;const s=e.doc.lastChild;return!f({node:s,types:t})}}})]}}export{J as B,te as C,se as H,oe as I,le as L,ie as O,_e as P,Oe as S,me as T,ke as U,ee as a,he as b,pe as c,ye as d,fe as e,be as f,ae as g,Me as h,re as i,De as j,de as k,ce as l,ge as m};
